import{_ as e,c as o,l as t}from"./index-6a1593c4.js";const s={data:()=>({loginForm:{username:"",password:""},loading:!1,capsTooltip:!1,passwordType:"password",title:""}),created(){document.title=this.docTitle,o().then((e=>{201===e.code?this.$router.replace("/register").catch():(this.title=e.data.title,document.title=this.title,this.$store.commit("SET_TITLE",this.title))}))},computed:{...Vuex.mapState(["docTitle"])},mounted(){this.$refs.password.focus()},methods:{showPwd(){"password"===this.passwordType?this.passwordType="":this.passwordType="password",this.$nextTick((()=>{this.$refs.password.focus()}))},checkCapslock(e){const{key:o}=e;this.capsTooltip=o&&1===o.length&&o>="A"&&o<="Z"},async handleLogin(){if(""===this.loginForm.username||""===this.loginForm.password)return void this.$message.error(this.$t("inputNotNull"));const e=Object.assign({},this.loginForm);e.password=CryptoJS.SHA224(this.loginForm.password).toString();const o=(await t(e)).token;let s=!1;"admin"===this.loginForm.username&&(s=!0),this.$store.commit("SET_ADMIN",s),this.$store.commit("LOGIN_IN",o),this.$router.replace("/").catch()}}},a={class:"login-container"},l={class:"title-container"},n={class:"title"},i={class:"svg-container"},r={class:"svg-container"};const c=e(s,[["render",function(e,o,t,s,c,d){const p=Vue.resolveComponent("svg-icon"),u=Vue.resolveComponent("el-input"),m=Vue.resolveComponent("el-form-item"),V=Vue.resolveComponent("el-tooltip"),h=Vue.resolveComponent("el-button"),w=Vue.resolveComponent("el-form");return Vue.openBlock(),Vue.createElementBlock("div",a,[Vue.createVNode(w,{ref:"loginForm",model:c.loginForm,class:"login-form",autocomplete:"on","label-position":"left"},{default:Vue.withCtx((()=>[Vue.createElementVNode("div",l,[Vue.createElementVNode("h3",n,Vue.toDisplayString(c.title),1)]),Vue.createVNode(m,{prop:"username"},{default:Vue.withCtx((()=>[Vue.createElementVNode("span",i,[Vue.createVNode(p,{"icon-class":"user"})]),Vue.createVNode(u,{ref:"username",modelValue:c.loginForm.username,"onUpdate:modelValue":o[0]||(o[0]=e=>c.loginForm.username=e),placeholder:"Username",name:"username",type:"text",tabindex:"1","auto-complete":"on"},null,8,["modelValue"])])),_:1}),Vue.createVNode(V,{visible:c.capsTooltip,"onUpdate:visible":o[4]||(o[4]=e=>c.capsTooltip=e),content:"Caps lock is On",placement:"right",manual:""},{default:Vue.withCtx((()=>[Vue.createVNode(m,{prop:"password"},{default:Vue.withCtx((()=>[Vue.createElementVNode("span",r,[Vue.createVNode(p,{"icon-class":"password"})]),(Vue.openBlock(),Vue.createBlock(u,{key:c.passwordType,ref:"password",modelValue:c.loginForm.password,"onUpdate:modelValue":o[1]||(o[1]=e=>c.loginForm.password=e),type:c.passwordType,placeholder:"Password",name:"password",tabindex:"2","auto-complete":"on",onKeyup:[d.checkCapslock,Vue.withKeys(d.handleLogin,["enter"])],onBlur:o[2]||(o[2]=e=>c.capsTooltip=!1)},null,8,["modelValue","type","onKeyup"])),Vue.createElementVNode("span",{class:"show-pwd",onClick:o[3]||(o[3]=(...e)=>d.showPwd&&d.showPwd(...e))},[Vue.createVNode(p,{"icon-class":"password"===c.passwordType?"eye":"eye-open"},null,8,["icon-class"])])])),_:1})])),_:1},8,["visible"]),Vue.createVNode(h,{loading:c.loading,type:"primary",style:{width:"100%","margin-bottom":"30px"},onClick:Vue.withModifiers(d.handleLogin,["prevent"])},{default:Vue.withCtx((()=>[Vue.createTextVNode(Vue.toDisplayString(e.$t("login")),1)])),_:1},8,["loading","onClick"])])),_:1},8,["model"])])}],["__scopeId","data-v-e2809386"]]);export{c as default};
